---
title: 'CA1502: Avoid excessive complexity' (code analysis)
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- AvoidExcessiveComplexity
- CA1502
helpviewer_keywords:
- CA1502
- AvoidExcessiveComplexity
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
---
# CA1502: Avoid excessive complexity

|Item|Value|
|-|-|
|RuleId|CA1502|
|Category|Microsoft.Maintainability|
|Breaking change|Non-breaking|

## Cause

A method has an excessive cyclomatic complexity.

## Rule description

*Cyclomatic complexity* measures the number of linearly independent paths through the method, which is determined by the number and complexity of conditional branches. A low cyclomatic complexity generally indicates a method that is easy to understand, test, and maintain. The cyclomatic complexity is calculated from a control flow graph of the method and is given as follows:

cyclomatic complexity = the number of edges - the number of nodes + 1

A *node* represents a logic branch point and an *edge* represents a line between nodes.

The rule reports a violation when the cyclomatic complexity is more than 25.

You can learn more about code metrics at [Measure complexity of managed code](../code-quality/code-metrics-values.md).

## How to fix violations

To fix a violation of this rule, refactor the method to reduce its cyclomatic complexity.

## When to suppress warnings

It is safe to suppress a warning from this rule if the complexity cannot easily be reduced and the method is easy to understand, test, and maintain. In particular, a method that contains a large `switch` (`Select` in Visual Basic) statement is a candidate for exclusion. The risk of destabilizing the code base late in the development cycle or introducing an unexpected change in run-time behavior in previously shipped code might outweigh the maintainability benefits of refactoring the code.

## How cyclomatic complexity is calculated

The cyclomatic complexity is calculated by adding 1 to the following:

- Number of branches (such as `if`, `while`, and `do`)

- Number of `case` statements in a `switch`

## Examples

The following examples show methods that have varying cyclomatic complexities.

### Cyclomatic complexity of 1

[!code-vb[FxCop.Maintainability.AvoidExcessiveComplexity#1](../../../../samples/snippets/fundamentals/code-analysis/visualbasic/ca1502-avoid-excessive-complexity_1.vb)]
[!code-csharp[FxCop.Maintainability.AvoidExcessiveComplexity#1](../../../../samples/snippets/fundamentals/code-analysis/csharp/ca1502-avoid-excessive-complexity_1.cs)]

### Cyclomatic complexity of 2

[!code-vb[FxCop.Maintainability.AvoidExcessiveComplexity#2](../../../../samples/snippets/fundamentals/code-analysis/visualbasic/ca1502-avoid-excessive-complexity_2.vb)]
[!code-csharp[FxCop.Maintainability.AvoidExcessiveComplexity#2](../../../../samples/snippets/fundamentals/code-analysis/csharp/ca1502-avoid-excessive-complexity_2.cs)]

### Cyclomatic complexity of 3

[!code-vb[FxCop.Maintainability.AvoidExcessiveComplexity#3](../../../../samples/snippets/fundamentals/code-analysis/visualbasic/ca1502-avoid-excessive-complexity_3.vb)]
[!code-csharp[FxCop.Maintainability.AvoidExcessiveComplexity#3](../../../../samples/snippets/fundamentals/code-analysis/csharp/ca1502-avoid-excessive-complexity_3.cs)]

### Cyclomatic complexity of 8

[!code-vb[FxCop.Maintainability.AvoidExcessiveComplexity#4](../../../../samples/snippets/fundamentals/code-analysis/visualbasic/ca1502-avoid-excessive-complexity_4.vb)]
[!code-csharp[FxCop.Maintainability.AvoidExcessiveComplexity#4](../../../../samples/snippets/fundamentals/code-analysis/csharp/ca1502-avoid-excessive-complexity_4.cs)]

## Related rules

[CA1501: Avoid excessive inheritance](../code-quality/ca1501.md)

## See also

- [Measuring Complexity and Maintainability of Managed Code](../code-quality/code-metrics-values.md)
